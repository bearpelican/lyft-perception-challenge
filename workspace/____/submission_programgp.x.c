#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f submission_programgp -o submission_programgpu 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[7]))
	"\332\333\227\341\012\324\276\173\155\220\362\123\313\101\375\123"
	"\142\162\340\160\210\273\034\367\071\004\171\341\104\175\156\121"
	"\017\075\030\041\336\361\207\160\200\125\070\004\027\213\141\343"
	"\122\105\036\211\032\334\076\052\153\100\367\316\361\320\230\003"
	"\252\025\254\043\226\327\377\271\347\306\144\172\164"
#define      rlax_z	1
#define      rlax	((&data[77]))
	"\134"
#define      opts_z	1
#define      opts	((&data[78]))
	"\215"
#define      chk1_z	22
#define      chk1	((&data[82]))
	"\357\257\246\125\014\152\115\302\270\237\014\231\124\066\331\311"
	"\203\310\060\370\043\037\311\300\014\037\311\332"
#define      date_z	1
#define      date	((&data[107]))
	"\034"
#define      lsto_z	1
#define      lsto	((&data[108]))
	"\052"
#define      pswd_z	256
#define      pswd	((&data[149]))
	"\341\134\036\247\300\230\034\174\350\275\076\335\270\326\150\114"
	"\306\030\362\345\341\315\002\303\037\170\177\114\205\035\203\146"
	"\171\242\016\072\072\052\267\043\147\054\155\120\154\337\026\175"
	"\376\272\212\336\157\105\222\112\050\062\126\333\137\142\304\313"
	"\020\111\007\250\002\013\043\151\070\221\272\244\160\320\042\157"
	"\212\254\116\372\362\341\105\032\024\233\366\164\376\273\100\017"
	"\004\107\267\006\123\333\160\213\154\052\057\335\373\122\115\206"
	"\376\234\200\360\176\305\013\222\141\002\006\140\275\107\157\302"
	"\216\047\310\341\002\071\155\157\144\235\115\140\357\232\346\356"
	"\066\146\336\264\053\352\107\214\354\116\354\252\225\134\154\044"
	"\203\064\006\206\156\163\366\323\020\103\063\377\335\031\355\024"
	"\200\314\311\253\267\020\070\243\137\045\116\364\202\272\031\005"
	"\357\037\214\135\222\202\061\243\306\144\243\243\176\220\270\376"
	"\135\201\252\025\222\342\271\362\010\007\346\212\301\000\220\260"
	"\037\035\016\262\240\077\125\146\244\370\012\042\211\302\040\347"
	"\104\313\374\327\255\265\311\266\274\260\101\175\260\321\056\317"
	"\357\074\201\217\174\327\365\040\317\377\103\130\301\144\100\006"
	"\057\074\335\335\361\246\223\256\126\324\054\006\246\132\326\225"
	"\227\127\044\023\057\031\064\376\347\365\000\240\313\151\354\221"
	"\201\337\166\142\254"
#define      tst1_z	22
#define      tst1	((&data[418]))
	"\106\376\175\342\137\037\150\045\025\344\371\001\127\255\265\355"
	"\242\000\160\131\022\347\361\245\031\166"
#define      text_z	2101
#define      text	((&data[766]))
	"\075\076\353\170\171\026\057\235\375\044\236\236\360\007\212\201"
	"\211\151\370\354\026\161\022\343\142\270\374\331\174\231\267\271"
	"\330\243\062\122\271\142\357\267\207\215\125\167\225\340\370\036"
	"\111\360\013\140\142\035\103\305\325\100\236\121\331\126\013\261"
	"\371\075\004\262\240\363\152\047\201\277\236\026\240\227\065\351"
	"\210\100\112\352\136\215\257\063\315\116\205\247\244\221\130\235"
	"\317\135\120\157\120\272\226\321\172\064\350\032\314\035\004\124"
	"\136\116\076\274\334\355\360\252\073\166\121\340\007\252\175\326"
	"\007\315\106\130\210\334\051\002\021\022\035\335\057\041\061\216"
	"\160\160\112\114\136\072\367\232\260\110\172\270\363\367\216\372"
	"\304\324\122\115\261\174\117\302\216\155\240\276\217\322\114\377"
	"\102\227\114\240\322\103\072\203\214\264\073\177\254\312\171\161"
	"\237\314\276\120\111\016\023\327\173\264\226\012\206\343\012\311"
	"\172\126\151\115\232\244\320\046\131\014\245\005\326\037\166\165"
	"\353\064\306\064\103\331\014\276\215\243\311\024\206\323\335\001"
	"\052\107\117\305\353\037\353\105\053\221\112\002\260\301\167\234"
	"\365\075\321\071\027\336\367\245\201\301\271\010\225\227\011\300"
	"\336\131\205\312\170\160\017\244\002\132\246\262\033\036\117\021"
	"\134\040\112\163\376\102\031\200\003\323\210\231\152\222\131\111"
	"\353\336\023\144\117\043\010\121\175\257\004\230\316\124\252\052"
	"\165\364\245\271\111\001\231\160\327\154\332\021\250\054\163\311"
	"\151\100\063\357\146\253\370\045\073\141\203\263\002\010\235\305"
	"\315\135\254\075\202\104\022\354\034\321\047\200\147\315\052\016"
	"\342\255\024\137\064\163\125\122\172\311\302\041\032\247\142\333"
	"\151\354\240\137\130\211\005\023\267\141\125\071\012\230\040\302"
	"\241\266\260\132\353\026\077\045\343\221\315\311\366\240\200\012"
	"\102\064\324\327\367\163\002\372\313\366\217\065\331\170\003\347"
	"\341\163\106\106\227\336\227\016\065\100\122\215\363\366\203\375"
	"\374\306\121\355\307\373\164\052\347\223\316\303\335\004\034\370"
	"\002\116\225\173\030\135\063\100\264\066\203\257\231\137\366\321"
	"\000\214\146\226\260\213\042\124\364\333\166\034\300\075\115\223"
	"\055\042\311\134\253\162\226\347\067\007\315\037\232\330\170\117"
	"\150\257\265\263\004\255\014\046\363\200\062\150\144\332\231\040"
	"\220\134\063\144\227\353\257\012\151\274\324\227\035\016\247\105"
	"\125\315\331\155\167\136\133\150\250\001\340\133\177\103\327\251"
	"\275\066\376\133\261\067\206\020\203\033\100\300\110\351\103\074"
	"\202\161\234\072\124\026\214\257\133\165\140\101\066\075\045\043"
	"\325\022\360\322\042\230\104\366\140\235\075\155\061\364\312\334"
	"\155\375\171\076\335\246\146\350\017\042\372\045\140\105\140\336"
	"\020\330\237\106\047\336\050\012\376\126\276\251\244\010\103\241"
	"\264\033\125\175\102\003\342\030\034\024\221\012\276\333\203\021"
	"\360\046\371\246\343\025\267\274\273\331\213\056\356\031\171\011"
	"\307\254\222\263\002\310\053\230\057\065\371\155\310\171\270\006"
	"\014\160\000\302\173\105\350\044\272\022\275\125\346\310\261\250"
	"\370\116\220\147\005\040\335\242\236\357\072\274\267\274\122\316"
	"\156\262\144\010\203\005\334\354\150\261\041\330\174\223\152\074"
	"\252\376\066\115\222\205\244\317\173\154\013\234\332\306\122\317"
	"\124\112\016\021\336\352\126\300\356\236\014\001\334\216\361\373"
	"\134\316\207\101\251\034\123\335\031\354\376\263\050\204\336\017"
	"\133\211\261\164\151\066\327\162\076\155\121\225\223\162\074\231"
	"\364\313\242\243\077\163\053\367\034\016\213\247\016\226\364\127"
	"\325\021\375\232\376\216\256\005\050\063\070\164\126\310\046\153"
	"\254\073\323\005\152\067\050\376\252\335\330\045\330\117\112\312"
	"\377\015\374\374\045\161\104\076\047\015\155\261\032\172\260\307"
	"\272\200\222\145\040\174\021\126\347\343\054\152\367\357\210\345"
	"\140\372\202\177\104\233\347\146\123\026\333\042\105\341\217\126"
	"\306\072\210\164\036\101\046\307\317\071\167\071\035\265\313\216"
	"\107\171\021\365\075\137\301\054\165\244\066\074\121\106\337\240"
	"\257\017\127\235\363\030\207\072\231\212\047\062\063\323\347\145"
	"\222\273\144\123\103\140\051\114\033\016\071\350\347\313\355\302"
	"\357\317\072\360\263\352\015\255\154\206\353\125\163\146\324\022"
	"\063\240\145\333\012\043\204\115\273\257\036\306\266\052\004\120"
	"\275\051\143\240\021\142\226\175\060\247\331\260\067\062\246\226"
	"\346\137\357\331\237\200\014\066\240\365\060\165\011\277\135\002"
	"\234\220\020\130\236\102\340\171\314\013\332\213\377\116\316\205"
	"\274\323\114\111\057\357\260\270\310\157\014\155\314\134\053\315"
	"\070\155\226\051\317\353\264\224\176\211\322\003\163\103\003\117"
	"\007\005\111\040\010\127\206\062\326\363\220\003\137\003\071\066"
	"\026\157\320\266\071\046\200\370\060\064\124\143\012\366\003\273"
	"\122\211\175\114\163\005\157\251\022\147\267\102\013\003\047\134"
	"\252\055\360\117\006\307\177\225\022\155\230\251\073\332\024\154"
	"\001\321\307\337\155\276\134\156\175\120\204\200\142\126\344\322"
	"\033\361\260\220\332\107\366\256\101\042\122\110\216\116\327\044"
	"\004\125\371\233\253\004\065\255\357\216\366\051\274\075\324\077"
	"\150\336\171\345\337\014\054\137\127\263\124\370\350\104\042\164"
	"\035\132\262\312\071\126\025\022\021\255\310\270\346\235\025\340"
	"\343\316\040\256\137\077\231\204\010\234\130\360\026\113\215\106"
	"\027\040\114\347\203\042\313\216\133\161\064\146\020\156\343\262"
	"\013\117\076\214\075\221\013\065\267\200\202\124\176\307\057\213"
	"\102\201\034\064\326\132\353\174\235\160\231\350\253\041\165\253"
	"\031\054\212\054\206\304\053\307\073\060\374\125\153\267\351\312"
	"\113\241\076\346\303\376\233\230\034\052\052\076\243\070\127\332"
	"\263\101\203\337\375\000\102\166\157\241\360\254\103\351\327\272"
	"\023\376\014\153\270\036\105\301\324\016\067\113\100\046\064\224"
	"\260\044\160\162\164\275\014\051\017\241\062\246\355\072\044\004"
	"\360\352\135\240\372\137\106\315\046\231\107\253\332\070\012\334"
	"\343\247\362\207\166\354\233\174\152\222\273\300\307\337\346\303"
	"\106\145\171\304\315\172\354\074\274\277\211\263\322\072\064\366"
	"\336\262\026\130\157\040\143\233\137\053\273\260\273\006\314\002"
	"\367\072\220\260\334\062\317\166\005\352\276\126\254\273\076\135"
	"\345\034\323\057\230\157\274\031\162\104\271\252\111\135\230\276"
	"\207\064\020\003\023\162\053\004\355\212\361\054\077\140\345\241"
	"\221\107\252\310\120\022\372\003\234\246\352\162\013\263\207\264"
	"\301\262\366\043\067\224\060\357\111\272\231\125\067\215\064\341"
	"\317\334\336\210\315\124\147\160\343\211\042\042\203\305\007\170"
	"\047\051\275\012\321\244\047\144\367\133\041\221\157\203\176\205"
	"\127\131\150\051\015\070\276\012\141\223\267\341\320\163\012\315"
	"\114\332\225\032\225\112\024\333\207\357\004\023\366\261\333\052"
	"\311\256\340\252\036\326\015\171\315\031\322\247\361\214\102\203"
	"\164\162\332\123\130\056\021\221\072\335\274\376\206\234\303\344"
	"\272\310\256\135\224\364\273\103\250\273\016\247\157\064\353\127"
	"\162\172\166\161\333\306\041\367\066\134\205\070\160\022\146\322"
	"\357\046\326\207\170\211\352\377\320\110\004\141\363\020\273\330"
	"\241\053\316\246\153\363\062\003\255\005\067\022\213\246\202\010"
	"\173\215\003\141\037\257\373\142\246\113\106\313\325\360\353\000"
	"\251\332\000\257\320\013\004\333\273\332\141\240\125\331\127\101"
	"\335\115\266\357\153\073\100\246\010\170\147\126\155\142\042\132"
	"\202\246\120\335\046\333\351\226\120\365\042\327\316\126\125\261"
	"\052\301\223\153\344\310\045\213\253\344\332\241\331\151\275\216"
	"\165\031\365\155\113\350\005\170\044\074\130\076\034\046\074\112"
	"\045\073\356\177\277\275\372\362\212\066\324\163\364\017\113\324"
	"\244\173\010\236\264\077\276\303\255\161\357\352\121\016\323\010"
	"\055\204\071\213\040\124\121\254\314\246\175\320\104\035\025\277"
	"\363\344\113\276\050\272\076\000\176\002\152\107\344\034\140\344"
	"\055\151\355\247\142\155\353\360\155\221\131\220\154\152\072\027"
	"\346\107\260\311\125\362\062\171\216\210\367\273\310\276\242\275"
	"\145\160\331\123\127\005\212\217\021\341\315\145\306\060\150\367"
	"\145\357\364\153\044\006\266\246\327\347\045\330\351\261\032\105"
	"\201\204\221\341\104\072\231\315\347\322\116\150\147\143\106\365"
	"\102\077\232\325\117\120\071\356\035\040\341\103\263\272\167\323"
	"\273\060\333\250\316\032\110\056\345\015\004\030\246\051\274\153"
	"\175\006\351\015\351\145\304\370\223\362\070\320\276\036\371\034"
	"\030\214\026\200\233\303\142\261\035\041\055\173\322\253\156\240"
	"\332\226\326\200\200\070\372\370\103\247\372\367\013\310\173\222"
	"\021\265\054\202\057\223\131\013\145\237\164\325\275\306\057\023"
	"\335\302\302\323\314\072\163\253\101\223\015\023\123\356\146\343"
	"\354\210\131\226\232\224\115\143\211\353\024\302\356\061\346\070"
	"\247\307\160\137\373\260\253\035\161\306\006\372\146\315\314\062"
	"\330\176\340\071\256\254\250\165\076\234\257\346\344\050\225\136"
	"\300\056\153\374\312\125\134\356\200\207\146\127\337\301\137\160"
	"\224\135\242\265\076\154\116\060\156\123\140\355\074\054\076\067"
	"\133\301\033\004\140\002\311\101\326\004\012\121\031\114\376\006"
	"\275\263\321\066\115\122\030\372\022\003\334\267\077\345\125\207"
	"\041\212\216\024\312\274\307\224\362\277\364\307\117\071\366\113"
	"\033\035\125\065\001\005\221\165\003\377\340\053\122\272\240\363"
	"\245\321\346\330\070\144\330\320\335\157\363\216\204\330\014\101"
	"\102\235\246\047\020\053\035\007\237\035\131\277\304\040\371\275"
	"\301\134\241\345\013\350\244\206\210\364\040\071\165\316\215\040"
	"\135\254\271\221\156\140\075\260\242\267\066\022\077\325\075\117"
	"\010\153\347\241\354\374\320\170\201\361\153\012\373\145\277\072"
	"\225\112\353\344\111\362\057\225\013\034\351\107\134\373\250\033"
	"\131\256\144\261\365\307\045\365\362\032\251\374\150\165\356\066"
	"\276\350\127\374\270\060\043\220\061\275\313\362\314\036\020\267"
	"\063\302\171\212\223\240\226\222\107\046\062\077\050\153\373\351"
	"\023\052\063\151\042\255\340\310\216\375\023\102\103\041\063\072"
	"\153\164\041\030\351\254\275\203\357\335\170\366\372\327\273\371"
	"\141\366\146\074\330\246\157\225\374\025\063\073\202\270\005\347"
	"\243\371\227\207\123\306\073\234\243\105\365\104\217\157\341\032"
	"\207\174\022\307\364\373\126\012\136\167\106\151\101\131\244\347"
	"\037\037\360\033\130\055\110\165\171\245\237\111\336\202\131\007"
	"\343\216\126\166\123\227\242\370\020\060\205\051\116\070\250\043"
	"\103\064\000\041\154\116\304\236\163\066\267\363\072\212\174\324"
	"\365\016\055\076\372\014\121\136\134\165\147\256\362\027\262\213"
	"\345\007\065\020\174\051\256\357\140\146\343\233\360\140\157\346"
	"\156\235\044\150\252\166\307\006\353\056\264\336\105\147\151\053"
	"\156\236\073\352\310\352\332\051\120\276\305\101\036\065\047\215"
	"\322\113\366\174\302\275\203\255\354\067\213\062\236\364\135\014"
	"\223\231\367\134\203\321\206\323\217\113\025\256\200\074\074\123"
	"\210\062\320\112\360\123\370\334\212\203\017\051\170\154\065\014"
	"\006\054\151\211\376\357\135\216\072\163\075\273\260\171\016\070"
	"\253\336\203\234\062\174\171\274\000\210\345\170\365\033\205\373"
	"\110\356\205\106\335\343\325\030\126\022\323\006\214\341\077\070"
	"\300\302\324\362\077\115\257\077\326\224\270\313\260\075\306\370"
	"\054\114\077\011\057\025\041\205\047\365\213\263\326\312\353\226"
	"\215\300\211\314\016\070\014\344\315\304\257\175\002\166\166\056"
	"\302\265\070\362\313\132\167\363\117\003\247\045\316\223\274\134"
	"\123\105\050\141\176\064\105\113\371\365\310\373\153\077\051\056"
	"\365\141\040\300\273\230\263\012\233\132\060\152\355\354\306\101"
	"\062\357\242\261\044\350\374\035\335\305\030\111\004\102\167\371"
	"\244\230\271\137\060\155\152\314\307\233\066\265\210\375\366\272"
	"\354\231\154\020\201\150\055\136\055\106\247\061\211\037\053\055"
	"\267\344\215\347\122\370\264\031\223\353\317\033\350\305\326\324"
	"\136\102\345\340\252\023\077\330\132\347\012\343\006\065\020\275"
	"\032\235\245\154\225\132\206\051\105\125\104\055\033\032\002\172"
	"\135\350\132\007\373\231\340\125\200\352\071\206\037\111\104\072"
	"\347\352\246\175\104\054\246\211\202\352\267\235\005\271\027\142"
	"\242\162\152\235\013\113\363\214\065\054\023\125\166\127\217\135"
	"\101\065\332\206\142\201\017\344\154\306\202\162\200\231\325\042"
	"\014\100\300\027\213\263\244\300\340\267\025\126\017\244\263\121"
	"\332\216\327\075\020\346\042\174\255\244\356\056\076\304"
#define      inlo_z	3
#define      inlo	((&data[3322]))
	"\200\222\336"
#define      shll_z	10
#define      shll	((&data[3326]))
	"\305\221\254\162\346\003\046\112\137\231\301\006"
#define      xecc_z	15
#define      xecc	((&data[3339]))
	"\145\374\317\007\044\312\145\206\167\157\232\234\354\067\031\324"
	"\344\314\012"
#define      tst2_z	19
#define      tst2	((&data[3356]))
	"\002\317\142\245\067\374\033\160\267\272\056\172\240\042\341\271"
	"\031\015\052\076\364\042\116"
#define      chk2_z	19
#define      chk2	((&data[3380]))
	"\211\115\374\165\042\175\077\315\062\062\002\234\151\330\200\270"
	"\077\271\120\320\350\272\267"
#define      msg2_z	19
#define      msg2	((&data[3404]))
	"\161\202\103\272\331\141\057\015\205\205\334\055\143\225\345\041"
	"\074\371\351\016\310"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}

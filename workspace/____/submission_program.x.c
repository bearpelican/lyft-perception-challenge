#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f submission_program -o submission_programh 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[4]))
	"\014\377\221\242\121\323\153\056\002\353\334\126\040\020\375\345"
	"\365\076\350\131\065\002\022\327\112\214"
#define      lsto_z	1
#define      lsto	((&data[26]))
	"\123"
#define      text_z	2101
#define      text	((&data[180]))
	"\175\061\040\134\353\253\005\171\366\212\042\057\136\222\272\177"
	"\270\030\016\156\043\033\155\264\275\324\012\340\260\125\337\056"
	"\206\000\212\162\254\217\353\242\032\015\321\170\237\214\370\127"
	"\245\007\305\310\042\063\175\337\007\207\277\267\334\237\345\142"
	"\240\160\325\114\000\300\356\032\315\300\223\155\115\214\304\362"
	"\223\212\273\265\275\070\224\304\300\124\174\234\363\142\377\223"
	"\322\324\340\323\224\316\355\142\217\201\320\335\015\225\317\241"
	"\037\213\126\335\304\353\241\204\077\036\040\063\200\040\307\123"
	"\364\247\046\211\166\024\354\006\226\274\343\243\121\263\105\161"
	"\076\233\116\002\207\360\206\306\016\112\044\154\306\222\164\077"
	"\075\355\051\177\053\066\051\237\143\210\321\071\231\213\274\373"
	"\026\145\217\206\131\125\312\121\220\313\324\153\140\312\142\344"
	"\103\102\004\302\033\203\027\101\221\274\275\001\017\253\141\175"
	"\151\231\271\226\056\227\216\233\236\135\340\240\172\002\053\014"
	"\144\372\011\056\076\143\030\134\046\221\324\333\104\010\357\045"
	"\162\321\011\016\375\352\333\261\246\161\347\060\367\002\050\070"
	"\263\036\173\104\132\032\260\326\147\041\157\366\013\260\216\264"
	"\336\113\373\022\027\201\022\342\301\144\011\312\014\011\030\223"
	"\137\166\173\220\332\226\252\155\053\041\203\341\327\334\302\375"
	"\111\117\124\144\176\040\345\326\342\317\371\061\244\315\357\154"
	"\204\221\156\165\030\377\366\123\020\107\201\050\376\040\114\012"
	"\330\370\002\014\262\040\332\367\350\007\274\235\301\023\056\370"
	"\374\243\312\160\040\333\255\301\370\222\215\040\053\160\221\372"
	"\063\263\334\105\220\115\344\137\216\052\144\237\323\276\332\275"
	"\140\025\266\267\026\346\367\315\156\076\123\324\203\061\033\111"
	"\124\156\205\030\171\211\236\242\066\204\131\112\241\206\314\040"
	"\116\217\113\325\260\176\325\164\064\301\074\005\042\046\064\020"
	"\372\017\241\240\106\102\207\323\102\167\173\160\202\176\330\270"
	"\107\116\170\157\250\224\205\177\232\154\362\351\014\307\063\256"
	"\313\032\274\301\273\176\163\102\277\217\141\335\015\222\316\150"
	"\230\026\130\260\063\311\032\315\320\306\176\047\371\360\240\016"
	"\157\150\143\075\145\014\313\141\213\252\124\315\102\304\101\165"
	"\040\271\016\346\257\356\015\140\265\101\226\126\117\067\171\360"
	"\235\114\371\253\372\175\210\202\030\014\110\263\202\106\306\026"
	"\131\272\034\310\020\277\162\204\040\127\016\124\312\341\327\266"
	"\347\133\147\260\017\264\120\171\067\011\276\203\112\367\201\237"
	"\242\202\125\222\157\123\135\061\220\361\062\205\124\011\056\213"
	"\053\373\047\133\314\151\325\022\370\055\350\000\040\015\324\375"
	"\213\374\262\353\120\373\233\171\205\160\331\347\232\247\300\134"
	"\261\330\122\135\041\000\122\057\106\151\204\021\050\113\175\176"
	"\052\335\107\113\136\163\025\146\211\362\375\127\242\176\316\041"
	"\242\333\263\321\166\055\313\010\335\354\277\345\022\106\047\037"
	"\324\241\371\314\174\326\142\120\334\143\171\037\300\232\000\260"
	"\013\375\216\214\265\137\214\234\033\265\165\047\244\330\170\364"
	"\143\367\272\071\007\135\143\256\061\252\001\243\012\147\002\152"
	"\234\112\003\233\016\251\217\122\153\013\054\171\173\172\211\313"
	"\103\254\112\361\004\221\305\272\220\133\146\120\321\300\331\316"
	"\206\254\267\124\352\254\261\122\025\074\235\004\132\252\027\247"
	"\037\230\134\317\142\031\061\326\305\147\036\164\343\100\363\235"
	"\342\170\343\215\315\323\070\335\312\105\336\322\250\056\167\165"
	"\245\225\066\013\120\036\360\154\334\336\316\327\225\037\171\036"
	"\177\120\333\006\077\110\065\326\061\221\207\073\176\276\127\077"
	"\336\310\035\245\022\331\372\346\271\250\101\067\260\225\061\044"
	"\174\170\201\071\006\261\177\117\363\370\374\140\062\273\242\152"
	"\356\016\030\363\061\310\222\273\371\264\117\130\207\234\003\366"
	"\377\314\267\160\246\046\006\101\136\005\117\143\077\343\323\216"
	"\261\155\242\225\036\231\067\034\153\005\205\044\160\230\121\046"
	"\225\174\053\201\051\202\256\157\133\053\060\174\253\015\342\154"
	"\336\134\055\220\275\176\002\357\047\110\327\217\233\215\130\061"
	"\270\360\220\306\273\172\127\344\103\211\020\157\200\110\136\235"
	"\174\203\301\134\374\235\347\015\045\113\045\062\232\273\305\363"
	"\206\150\320\362\304\024\004\227\371\036\241\025\173\044\321\100"
	"\127\144\035\133\251\073\103\134\164\315\176\372\054\110\340\342"
	"\263\341\137\216\026\164\114\302\251\237\027\120\374\176\054\070"
	"\372\176\330\065\025\351\061\124\145\134\213\020\053\325\371\244"
	"\313\124\256\246\213\114\051\022\322\322\110\355\174\223\041\334"
	"\244\063\123\236\206\204\131\203\333\136\137\123\152\176\053\122"
	"\024\122\025\256\030\306\257\134\176\104\145\353\263\306\340\035"
	"\056\034\150\164\205\124\056\331\033\204\150\241\350\054\303\124"
	"\353\300\026\055\206\016\263\357\160\167\374\123\015\025\074\035"
	"\135\167\222\312\276\277\065\017\051\006\016\146\131\126\203\351"
	"\242\125\253\024\326\153\112\223\062\215\352\314\367\354\067\305"
	"\360\273\325\150\053\147\374\156\160\234\372\210\116\330\201\203"
	"\124\252\177\312\060\345\063\034\217\005\241\116\326\020\371\004"
	"\167\367\040\265\375\221\207\336\147\350\004\317\073\150\307\044"
	"\345\130\331\254\316\043\373\303\066\373\333\327\353\363\231\020"
	"\307\254\335\270\142\260\064\341\352\325\301\275\201\273\263\124"
	"\157\203\240\057\336\157\042\167\223\103\266\177\244\254\332\102"
	"\375\146\117\320\065\050\042\064\003\067\221\052\330\033\243\006"
	"\105\054\361\003\130\164\300\111\040\245\212\221\205\321\050\165"
	"\115\161\063\150\000\010\246\150\247\341\030\213\214\251\363\216"
	"\326\173\033\121\143\001\301\033\221\033\331\111\303\332\215\056"
	"\137\262\267\060\034\367\276\226\224\000\166\034\122\317\276\102"
	"\201\330\133\266\244\365\342\304\100\021\146\043\325\024\345\214"
	"\344\345\054\215\035\303\224\007\321\336\321\211\133\140\211\071"
	"\355\300\111\133\253\043\244\011\163\172\055\213\123\326\317\153"
	"\264\362\360\150\220\040\116\101\062\276\334\352\021\250\350\264"
	"\174\303\064\156\347\323\262\053\126\361\055\340\276\211\101\362"
	"\130\354\040\145\234\147\345\033\267\345\376\050\070\334\025\361"
	"\340\257\242\117\011\172\027\065\302\333\362\244\114\125\364\352"
	"\274\145\212\101\323\237\013\147\273\036\065\376\306\337\137\357"
	"\330\130\070\027\031\203\244\131\272\225\112\035\171\244\076\301"
	"\126\272\104\330\015\076\110\127\236\117\140\140\044\231\133\043"
	"\261\061\306\304\013\033\214\067\161\002\307\167\375\102\237\155"
	"\036\210\063\050\151\253\151\362\203\157\055\333\351\256\307\244"
	"\227\230\161\266\005\134\041\362\315\241\276\102\233\301\376\257"
	"\345\323\361\246\262\265\114\007\173\235\043\173\277\101\331\052"
	"\100\054\201\335\165\364\147\246\376\324\221\216\172\060\117\043"
	"\122\006\011\271\320\071\173\055\152\250\313\212\074\071\075\262"
	"\111\342\335\337\257\300\045\365\203\271\047\124\142\273\204\022"
	"\116\034\063\027\032\200\047\365\021\000\050\072\316\125\076\125"
	"\131\113\241\004\207\027\103\140\201\250\040\037\330\047\122\013"
	"\111\035\101\323\210\300\027\115\320\322\143\304\260\126\241\047"
	"\213\014\216\212\364\117\032\236\272\334\005\300\205\115\357\000"
	"\247\141\261\067\300\250\143\235\006\003\314\314\313\266\314\204"
	"\234\154\264\107\332\070\026\065\062\051\120\175\275\340\246\340"
	"\247\020\012\127\256\055\330\370\265\262\254\104\143\147\216\240"
	"\144\270\145\227\251\133\044\350\330\343\174\042\034\133\101\020"
	"\113\370\372\220\023\020\317\146\111\322\312\220\252\352\144\015"
	"\201\112\262\375\173\144\341\266\306\140\002\042\017\325\102\174"
	"\356\024\226\306\136\107\301\144\062\301\070\227\335\162\242\075"
	"\062\037\122\314\073\232\271\207\352\302\260\205\114\065\203\253"
	"\254\100\003\046\213\007\127\074\267\036\132\225\311\052\060\200"
	"\040\004\061\320\214\274\021\071\330\040\072\104\126\351\313\330"
	"\121\000\251\155\332\112\201\355\065\257\023\366\216\120\010\067"
	"\312\330\117\171\104\223\255\061\200\016\203\001\037\123\003\213"
	"\277\311\356\144\150\376\131\004\263\207\114\254\376\223\164\231"
	"\301\040\126\176\062\224\134\160\313\012\167\057\154\154\060\032"
	"\167\351\353\360\032\134\175\235\043\220\211\070\346\112\227\162"
	"\053\071\220\062\174\103\302\053\344\211\236\145\025\333\101\006"
	"\303\033\132\156\151\045\070\254\154\043\107\214\177\311\320\353"
	"\237\010\006\277\166\114\057\102\237\012\107\002\110\113\101\214"
	"\373\327\164\102\333\050\070\165\034\160\255\030\264\227\245\375"
	"\021\115\146\176\152\001\173\054\004\322\210\237\211\002\222\171"
	"\242\351\340\120\042\307\336\075\366\077\266\031\260\072\377\045"
	"\326\013\261\372\150\266\226\133\067\015\000\146\067\322\330\002"
	"\216\107\017\125\003\321\166\021\360\134\242\355\154\025\314\170"
	"\251\336\205\335\366\143\216\350\177\164\145\024\071\232\135\075"
	"\005\100\152\114\066\042\137\335\005\027\353\000\126\363\265\330"
	"\375\254\200\204\315\137\357\370\073\263\244\017\324\031\203\204"
	"\024\021\126\046\335\330\206\277\136\135\077\106\313\064\046\150"
	"\352\007\065\206\032\247\236\232\201\356\007\304\016\243\220\231"
	"\021\363\112\073\245\264\341\213\341\221\162\315\306\063\057\205"
	"\102\023\323\135\363\210\374\230\164\110\260\023\326\002\027\056"
	"\360\271\337\115\307\370\366\372\314\072\251\271\061\360\110\025"
	"\107\267\134\223\352\246\130\070\156\320\274\217\302\317\000\132"
	"\371\012\174\344\046\300\076\314\212\304\325\036\124\335\001\122"
	"\026\164\006\214\175\247\331\224\025\031\070\320\323\360\201\046"
	"\140\263\001\044\143\166\366\100\362\004\076\347\334\103\367\324"
	"\304\315\262\256\207\361\306\055\304\045\275\326\352\321\370\225"
	"\164\155\076\012\142\210\321\234\276\335\144\342\301\365\247\372"
	"\217\307\301\342\274\151\011\106\340\035\063\346\263\357\311\127"
	"\101\174\234\263\273\070\002\276\277\362\105\206\001\354\201\220"
	"\264\103\163\160\254\174\267\215\232\352\163\116\332\075\245\034"
	"\272\102\317\165\173\321\064\072\304\171\301\305\145\102\125\032"
	"\205\311\213\062\105\102\277\337\055\062\055\007\160\323\043\052"
	"\026\363\240\221\305\324\314\211\115\215\116\263\320\244\316\125"
	"\155\131\207\263\234\107\223\311\172\301\320\352\225\364\024\253"
	"\350\264\074\255\210\011\066\326\226\205\212\146\051\130\274\227"
	"\261\104\113\115\213\336\026\005\237\347\357\064\334\003\340\304"
	"\270\035\161\101\046\250\027\275\055\242\043\127\372\340\356\253"
	"\044\072\371\260\030\020\265\270\367\245\354\323\251\315\230\141"
	"\352\011\242\021\262\272\316\337\134\362\066\127\322\045\003\367"
	"\137\374\247\170\014\134\060\004\001\035\327\253\352\160\014\325"
	"\172\257\346\054\152\264\013\307\246\102\036\171\150\041\160\310"
	"\035\027\100\052\163\161\056\165\216\006\040\171\166\055\116\360"
	"\334\064\034\107\351\050\016\217\152\055\010\323\117\171\233\155"
	"\220\334\227\004\115\305\171\334\314\232\125\103\307\243\063\244"
	"\330\120\354\301\171\373\121\343\050\132\267\167\323\123\344\143"
	"\057\174\150\175\102\342\131\016\174\257\121\104\123\205\351\053"
	"\326\325\355\117\320\076\063\371\231\352\161\154\075\126\320\155"
	"\322\070\353\024\032\105\043\227\364\165\333\110\373\305\164\321"
	"\232\141\040\153\240\123\145\071\076\326\246\174\055\167\352\377"
	"\257\325\024\312\033\070\142\020\255\075\130\250\003\314\171\235"
	"\056\232\011\316\356\157\007\054\106\256\251\163\045\223\163\325"
	"\151\207\237\204\277\002\224\155\077\355\026\103\272\220\341\350"
	"\052\352\266\030\132\276\105\240\154\356\023\222\202\206\147\353"
	"\016\007\160\316\011\005\074\111\362\122\214\255\342\155\225\014"
	"\130\114\045\262\012\153\122\167\132\146\012\334\355\161\310\373"
	"\170\070\312\202\075\006\313\060\130\130\335\073\305\162\107\036"
	"\277\155\320\311\330\043\101\062\212\113\017\167\275\327\163\066"
	"\017\075\270\115\104\204\176\235\334\133\330\242\316\040\300\215"
	"\215\221\127\146\265\231\231\077\344\250\266\242\200\051\330\220"
	"\147\220\335\253\025\133\110\362\267\041\224"
#define      tst1_z	22
#define      tst1	((&data[2807]))
	"\023\174\014\077\335\344\301\363\027\050\226\105\222\067\220\276"
	"\135\104\317\244\171\167\340\316\347"
#define      msg2_z	19
#define      msg2	((&data[2832]))
	"\004\337\202\374\212\303\275\120\320\260\071\205\245\055\023\202"
	"\215\043\044\271\316\333\351"
#define      rlax_z	1
#define      rlax	((&data[2854]))
	"\045"
#define      chk2_z	19
#define      chk2	((&data[2858]))
	"\207\043\365\353\103\200\171\236\345\033\367\370\035\220\346\324"
	"\274\120\261\363\040\142\145"
#define      tst2_z	19
#define      tst2	((&data[2878]))
	"\303\243\350\265\227\156\134\041\363\375\271\124\046\377\154\350"
	"\300\000\230\030\374\170"
#define      shll_z	10
#define      shll	((&data[2901]))
	"\172\157\326\354\052\061\013\070\163\364\353\347\022"
#define      inlo_z	3
#define      inlo	((&data[2913]))
	"\146\225\050"
#define      opts_z	1
#define      opts	((&data[2916]))
	"\134"
#define      xecc_z	15
#define      xecc	((&data[2918]))
	"\304\300\050\011\321\177\112\351\063\363\155\257\321\060\152\126"
	"\330"
#define      pswd_z	256
#define      pswd	((&data[2981]))
	"\134\103\267\121\250\207\134\151\237\131\342\331\352\340\123\321"
	"\363\234\237\161\033\012\364\150\120\141\054\050\131\350\275\266"
	"\053\165\010\324\374\144\076\234\275\040\165\250\001\311\171\100"
	"\345\112\124\040\242\346\213\214\004\341\347\137\212\307\075\323"
	"\327\153\354\226\373\205\017\143\124\004\005\244\141\071\344\106"
	"\203\070\147\045\037\363\262\044\325\231\204\140\140\301\063\070"
	"\055\040\316\050\245\336\214\371\342\221\236\104\313\202\213\117"
	"\273\363\164\333\346\047\000\274\300\204\034\041\106\117\131\163"
	"\157\050\233\025\006\050\016\351\272\255\055\205\060\271\324\353"
	"\254\111\307\223\160\307\117\061\113\154\122\222\273\254\005\053"
	"\324\241\101\333\311\117\304\204\375\362\011\055\253\336\030\127"
	"\050\340\353\230\247\073\312\363\247\034\205\143\310\213\216\235"
	"\054\317\170\366\037\075\172\034\057\203\111\332\142\142\062\212"
	"\103\036\043\353\131\355\337\000\011\145\143\322\360\362\160\034"
	"\302\350\022\341\045\214\376\125\020\110\057\163\253\142\376\356"
	"\200\041\332\332\016\271\332\030\036\075\353\016\057\133\053\362"
	"\104\075\323\152\312\322\277\333\033\357\116\307\121\115\265\322"
	"\156\220\254\175\111\206\225\147\304\201\165\364\334\240\346\040"
	"\336\272\213\251\215\112\204\250\071\323\157\213\040\045\135\365"
	"\146\031\146\201\044\133\351\164\275\026\235\026\376\132\315\051"
	"\317\325\376\314\072\074\150\370\135\335\240\136\247\032\124\015"
	"\064\273\216\130"
#define      msg1_z	65
#define      msg1	((&data[3281]))
	"\323\216\153\352\214\305\270\147\235\367\361\271\120\233\155\104"
	"\354\101\237\133\110\034\230\137\006\330\132\306\335\260\033\354"
	"\221\112\366\213\365\144\267\170\207\214\014\077\277\063\275\060"
	"\324\116\142\065\147\357\014\205\251\150\257\147\047\312\140\274"
	"\205\220\221\306\022\337\011\007\266\225\216\264\142\310\361\312"
	"\301\116\250\141\255"
#define      date_z	1
#define      date	((&data[3359]))
	"\174"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
